# erd_nginx.conf

upstream django {
    # взаимодействие с uwsgi через Unix-сокет
    server unix:///var/virtualenv/erd/uwsgi.sock;
}

# конфигурация веб-сервера
server {
    listen 1520;       # порт, который будет слушать веб-сервер в ожидании запросов от пользователй
    listen [::]:1520;
    server_name dj-erd.info.nu;  # доменное имя, замените на собственный домен или IP адрес
    charset utf-8;

    # максимальный размер загружаемых на сервер данных
    client_max_body_size 75M;

    
    # обслуживание медиа файлов
    location /media  {
        # расположение медиафайлов
        alias /var/virtualenv/erd/media;
    }

    # обслуживание статики
    location /static {
        # расположение статики
        alias /var/virtualenv/erd/static;
    }

    # Остальные запросы перенаправляются в Django приложение
    location / {
        uwsgi_pass  django;
        include     /var/virtualenv/erd/erd/uwsgi_params; # файл uwsgi_params, который мы только что взяли с github
    }
}